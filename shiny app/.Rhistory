shiny::runApp()
runApp('~/Desktop/git_server/marathon-web-5')
df = read.csv("data/oneWeekfullCleanedData.csv")
getwd()
setwd("~/Desktop/ter/Shiny_ter/TER")
getwd()
source('~/Desktop/ter/Shiny_ter/TER/map.R')
View(df)
colnames(df)
df$Country_code
df$Country_name
# récupération des données pays
pays = read.csv2("data/pays2020.csv",sep = ',')
df$Country_code
View(df)
nb_click = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total = sum(click))
View(nb_click)
world_spdf <- readOGR(
dsn= paste0(getwd(),"/data/world_border/") ,
layer="TM_WORLD_BORDERS_SIMPL-0.3",
verbose=FALSE
)
world_spdf@data$POP2005[ which(world_spdf@data$POP2005 == 0)] = NA
world_spdf@data$POP2005 <- as.numeric(as.character(world_spdf@data$POP2005)) / 1000000 %>% round(2)
mypalette <- colorNumeric( palette="viridis", domain=world_spdf@data$POP2005, na.color="transparent")
mypalette(c(45,43))
# Basic choropleth with leaflet?
m <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons( fillColor = ~mypalette(POP2005), stroke=FALSE )
m
View(world_spdf)
View(world_spdf)
world_spdf <- inner_join(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
world_spdf <- merge(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
mypalette <- colorNumeric( palette="viridis", domain=world_spdf@data$POP2005, na.color="transparent")
mypalette(c(45,43))
nb_click
mypalette <- colorNumeric( palette="viridis", domain=world_spdf@data$total, na.color="transparent")
mypalette(c(45,43))
m <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons( fillColor = ~mypalette(POP2005), stroke=FALSE )
m
mypalette <- colorNumeric( palette="viridis", domain=world_spdf@data$total, na.color="transparent",  bins=mybins)
mybins <- c(1,10,20,50,100,10000,Inf)
mypalette <- colorNumeric( palette="viridis", domain=world_spdf@data$total, na.color="transparent",  bins=mybins)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total, na.color="transparent",  bins=mybins)
world_spdf <- merge(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
mybins <- c(1,10,20,50,100,10000,Inf)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total, na.color="transparent",  bins=mybins)
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks: ", round(world_spdf@data$total, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
View(world_spdf)
world_spdf <- merge(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
View(world_spdf)
nb_click$Country_code
world_spdf@data$ISO2
# jointure entre les données mondiales et les données de stage
world <-merge(world_spdf,interships_counts_by_country,by.x="ISO3", by.y = "codeiso3", all= TRUE)
world_spdf <- merge(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
df = read.csv("data/oneWeekfullCleanedData.csv")
nb_click = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total = sum(click))
world_spdf <- readOGR(
dsn= paste0(getwd(),"/data/world_border/") ,
layer="TM_WORLD_BORDERS_SIMPL-0.3",
verbose=FALSE
)
world_spdf@data$POP2005[ which(world_spdf@data$POP2005 == 0)] = NA
world_spdf@data$POP2005 <- as.numeric(as.character(world_spdf@data$POP2005)) / 1000000 %>% round(2)
world_spdf <- merge(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
View(world_spdf)
world_spdf@data$total
mybins <- c(1,10,20,50,100,10000,Inf)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total, na.color="transparent",  bins=mybins)
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks: ", round(world_spdf@data$total, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Basic choropleth with leaflet?
m <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(number_internships),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~number_internships, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
# Basic choropleth with leaflet?
m <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(number_internships),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
# Basic choropleth with leaflet?
m <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
m
mybins <- c(1,10,20,50,100,1000)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total, na.color="transparent",  bins=mybins)
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks: ", round(world_spdf@data$total, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
# Basic choropleth with leaflet?
m <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
m
nb_win = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total = sum(win))
nb_win = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total = n())
View(nb_win)
world_spdf <- merge(world_spdf,nb_win ,by.x="ISO2", by.y = "Country_code", all= TRUE)
df = read.csv("data/oneWeekfullCleanedData.csv")
nb_click = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total_click = sum(click))
nb_win = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total_win = n())
world_spdf <- readOGR(
dsn= paste0(getwd(),"/data/world_border/") ,
layer="TM_WORLD_BORDERS_SIMPL-0.3",
verbose=FALSE
)
world_spdf@data$POP2005[ which(world_spdf@data$POP2005 == 0)] = NA
world_spdf@data$POP2005 <- as.numeric(as.character(world_spdf@data$POP2005)) / 1000000 %>% round(2)
world_spdf <- merge(world_spdf,nb_click ,by.x="ISO2", by.y = "Country_code", all= TRUE)
world_spdf <- merge(world_spdf,nb_win ,by.x="ISO2", by.y = "Country_code", all= TRUE)
mybins <- c(1,10,20,50,100,1000)
mybins2 <- c(1,10,20,50,100,1000, 10000, Inf)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total_win, na.color="transparent",  bins=mybins)
m1 <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total_win),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total_win, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
m1
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks/win: ", round(world_spdf@data$total, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
m1 <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total_win),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total_win, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
mybins <- c(1,10,20,50,100,1000)
mybins2 <- c(1,10,20,50,100,1000, 10000, Inf)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total_win, na.color="transparent",  bins=mybins2)
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks/win: ", round(world_spdf@data$total, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks/win: ", round(world_spdf@data$total_win, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
m1 <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total_win),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total_win, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
m1
mybins2 <- c(1,10,20,50,100,1000, 30000)
m1 <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total_win),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total_win, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
m1
mybins2 <- c(1,10,20,50,100,1000, 30000)
mypalette <- colorBin( palette="viridis", domain=world_spdf@data$total_win, na.color="transparent",  bins=mybins2)
mytext <- paste(
"Pays: ", world_spdf@data$NAME,"<br/>",
"Nombre de clicks/win: ", round(world_spdf@data$total_win, 2), "<br/>",
sep="") %>%
lapply(htmltools::HTML)
m1 <- leaflet(world_spdf) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(total_win),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~total_win, opacity=0.9, title = "Nombre de stages", position = "bottomleft" )
m1
shiny::runApp()
df = read.csv("data/data_one_month_cleaned_over_sampling.csv")
nb_click = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total_click = sum(click))
colnames(df)
install.packages("countrycode")
library(countrycode)
df = read.csv("data/data_one_month_cleaned_over_sampling.csv")
nb_click = df %>%
group_by(Country_name) %>%
summarise(total_click = sum(click))
View(nb_click)
nb_click = df %>%
group_by(Country_name) %>%
summarise(total_click = sum(click))
df$Country_name
colnames(df)
df$click
df = read.csv("data/data_one_month_cleaned_over_sampling.csv")
nb_click = df %>%
group_by(Country_name) %>%
summarise(total_click = sum(click))
View(df)
library(dplyr)
library(leaflet)
library(rgdal)
library(RColorBrewer)
library(countrycode)
df = read.csv("data/data_one_month_cleaned_over_sampling.csv")
nb_click = df %>%
group_by(Country_name) %>%
summarise(total_click = sum(click))
View(nb_click)
nb_click = df %>%
group_by(Country_name) %>%
summarise(total_click = sum(click))
df = read.csv("data/oneWeekfullCleanedData.csv")
nb_win = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total_win = n())
nb_win = df %>%
group_by(Country_code,
Country_name) %>%
summarise(total_win = n())
